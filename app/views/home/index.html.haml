%nav.navbar.navbar-default
  .container-fluid
    .navbar-header
      %h1.navbar-brand.welcome Welcome #{current_user.username}
      / %button.btn.btn-default.navbar-btn{:type => "button"} Sign in
      - if user_signed_in?
        / %h3 you have succesfully signed in
        = link_to 'View profile', edit_user_registration_path, :class => 'navbar-link'
        |
        = link_to "Sign Out", destroy_user_session_path, :method => :delete, class: 'button btn btn-default navbar-btn'
      - else
        = link_to "Sign In", new_user_session_path, :method => :get, class: 'button btn btn-default navbar-btn'
        = link_to "Sign Up", new_user_registration_path, :method => :get, class: 'button btn btn-default navbar-btn'
.panel.panel-default
  .panel-heading Friends List:
  %table.table-hover.table-condensed
    - @users.each do |user|
      -binding.pry
      - if user != current_user && user.pending && !current_user.pending.include?(user) && !current_user.active_friends.include?(user) && !current_user.received_friends.include?(user)
        %tr
          %td= user.username
          %td= link_to "Add Friend", friendships_path(friend_id: user), method: :post

.panel.panel-default
  .panel-heading Your awaiting friend requests:
  %table.table-hover.table-condensed
    - current_user.requested_friendships.each do |request|
      -unless current_user.active_friends.include?(request)
        %tr
          %td= request.username
          %td= link_to "Accept",  friendship_path(id: request.id), method: "put"
          / %td= link_to "Accept",  friendship_path(friend_id: request.pending.first.id, user_id: request.id), method: "put"
          %td= link_to "Decline", friendship_path(id: request.id), method: :delete

.panel.panel-default
  .panel-heading Your sent friend requests:
  %table.table-hover.table-condensed
    - current_user.pending_friends.each do |request|
      %tr
        %td= request.username
        / = link_to "Accept",  friendship_path(id: request.id), method: "put"
        %td= link_to "Decline", friendship_path(id: request.id), method: :delete
    / - current_user.requested_friendships.each do |request|
    /   %tr
    /     %td= request.username
    /     / = link_to "Accept",  friendship_path(id: request.id), method: "put"
    /     %td= link_to "Decline", friendship_path(id: request.id), method: :delete

.panel.panel-default
  .panel-heading Active users:
  %table.table-hover.table-condensed
    - current_user.active_friends.each do |request|
      %tr
        %td= request.username
        / = link_to "Accept",  friendship_path(id: request.id), method: "put"
        %td= link_to "Decline", friendship_path(id: request.id), method: :delete
    - current_user.received_friends.each do |request|
      %tr
        %td= request.username
        / = link_to "Accept",  friendship_path(id: request.id), method: "put"
        %td= link_to "Decline", friendship_path(id: request.id), method: :delete

